<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Maximum Reality Pets</title>
  <style>
    body { 
      font-family: sans-serif; 
      padding: 20px; 
      background: url('bg_wp.jpg') no-repeat center center fixed;
      background-size: cover;
      color: #fff;
      text-align: center;
    }
    .pet-card { 
      border: 2px solid #fff; 
      padding: 10px; 
      margin: 20px auto; 
      width: 200px; 
      text-align: center;
      background-color: rgba(0,0,0,0.5);
      border-radius: 10px;
    }
    .pet-card img { 
      width: 80px; 
      height: 80px; 
      image-rendering: pixelated; 
      margin-bottom: 5px;
      border: 1px solid #fff;
      border-radius: 5px;
      background-color: #000;
    }
    input { 
      margin: 5px 0; 
      width: 150px; 
      padding: 5px; 
      border-radius: 5px; 
      border: 1px solid #ccc; 
    }
    button { 
      margin-top: 5px; 
      cursor: pointer; 
      padding: 5px 10px; 
      border-radius: 5px; 
      border: none; 
      background-color: #ffcc00; 
      color: #000; 
      font-weight: bold; 
    }
    h1 { text-shadow: 2px 2px 4px #000; }
  </style>
</head>
<body>
  <h1>üêæ Maximum Reality Pets</h1>

  <div>
    <input id="petName" placeholder="Pet Name">
    <input id="petSpecies" placeholder="Species">
    <button onclick="createPet()">Create Pet</button>
  </div>

  <div id="petContainer"></div>

  <!-- Firebase -->
  <script src="https://www.gstatic.com/firebasejs/10.7.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.7.0/firebase-firestore-compat.js"></script>

  <script>
    // ===== Firebase config =====
    const firebaseConfig = {
      apiKey: "AIzaSyDkpW7RAmX0wPmL757_GzEFIoU6snssLnA",
      authDomain: "pets-86c25.firebaseapp.com",
      projectId: "pets-86c25",
      storageBucket: "pets-86c25.firebasestorage.app",
      messagingSenderId: "556129222317",
      appId: "1:556129222317:web:12d323a5165eb222d59024"
    };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();

    // ===== Sprites =====
    const speciesSprites = {
      bunny: "bunny.png",
      frog: "frog.png",
      fox: "fox.png",
      cat: "cat.png",
      dragon: "dragon.png",
      unicorn: "unicorn.png",
      dog: "dog.png"
    };

    let currentPet = null;
    const petContainer = document.getElementById("petContainer");

    // Render a single pet
    function renderPet(pet) {
      petContainer.innerHTML = `
        <div class="pet-card">
          <h2>${pet.name} (${pet.species})</h2>
          <img src="${pet.sprite}" alt="${pet.species}">
          <div>Hunger: ${Math.round(pet.stats.hunger)}</div>
          <div>Happiness: ${Math.round(pet.stats.happiness)}</div>
          <div>Energy: ${Math.round(pet.stats.energy)}</div>
          <div>Health: ${Math.round(pet.stats.health)}</div>
          <button onclick="feedPet('${pet.id}')">Feed</button>
        </div>
      `;
    }

    // Fetch the latest pet
    async function fetchLatestPet() {
      const snapshot = await db.collection("pets").orderBy("lastUpdated", "desc").limit(1).get();
      if (!snapshot.empty) {
        currentPet = { id: snapshot.docs[0].id, ...snapshot.docs[0].data() };
        renderPet(currentPet);
      }
    }

    // Create a new pet
    async function createPet() {
      const name = document.getElementById("petName").value;
      const species = document.getElementById("petSpecies").value.toLowerCase();
      if (!name || !species || !speciesSprites[species]) return alert("Invalid name or species");

      const pet = {
        name,
        species,
        sprite: speciesSprites[species],
        stats: { hunger: 50, happiness: 50, energy: 50, health: 100 },
        lastUpdated: Date.now()
      };

      const ref = await db.collection("pets").add(pet);
      currentPet = { id: ref.id, ...pet };
      renderPet(currentPet);

      document.getElementById("petName").value = "";
      document.getElementById("petSpecies").value = "";
    }

    // Feed current pet
    async function feedPet(id) {
      if (!currentPet || currentPet.id !== id) return;

      const stats = { ...currentPet.stats };
      stats.hunger = Math.max(0, stats.hunger - 20);
      stats.happiness = Math.min(100, stats.happiness + 5);

      await db.collection("pets").doc(id).update({
        stats,
        lastUpdated: Date.now()
      });

      currentPet.stats = stats;
      renderPet(currentPet);
    }

    // Auto-update hunger/happiness every 10 sec
    setInterval(async () => {
      if (!currentPet) return;
      const now = Date.now();
      const hoursPassed = (now - currentPet.lastUpdated) / (1000*60*60);
      if (hoursPassed > 0) {
        const stats = { ...currentPet.stats };
        stats.hunger = Math.min(100, stats.hunger + 5*hoursPassed);
        stats.happiness = Math.max(0, stats.happiness - 3*hoursPassed);
        if (stats.hunger > 80 || stats.happiness < 20) stats.health = Math.max(0, stats.health - 5*hoursPassed);

        await db.collection("pets").doc(currentPet.id).update({
          stats,
          lastUpdated: now
        });

        currentPet.stats = stats;
        renderPet(currentPet);
      }
    }, 10000);

    // Load latest pet on page load
    fetchLatestPet();
  </script>
</body>
</html>
